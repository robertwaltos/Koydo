@import "tailwindcss";
@custom-variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

:root {
  --background: #fffdf6;
  --foreground: #2f2942;
  --surface: #ffffff;
  --surface-muted: #f9f2ff;
  --border: #ead8ff;
  --accent: #ff7aa2;
  --success: #22b46e;
  --warn: #ffb341;
  --danger: #ff5f7f;
  --gradient-hero: linear-gradient(135deg, #ffe6f3 0%, #fff6d7 50%, #dbf8ff 100%);
  --radius-card: 18px;
  --radius-pill: 999px;
  --radius-organic: 14px 20px 16px 22px;
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.92),
    9px 9px 18px rgba(131, 92, 153, 0.15);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(131, 92, 153, 0.16),
    inset -5px -5px 10px rgba(255, 255, 255, 0.88);
  --dur-fast: 160ms;
  --dur-normal: 260ms;
  --ease-organic: cubic-bezier(0.22, 1, 0.36, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --focus-ring: color-mix(in srgb, var(--accent) 68%, white 32%);
  --type-display-2xl: clamp(2.6rem, 5.8vw, 5rem);
  --type-display-xl: clamp(2.15rem, 4.2vw, 3.75rem);
  --type-display-lg: clamp(1.85rem, 2.8vw, 2.85rem);
  --type-heading-xl: clamp(1.6rem, 2.2vw, 2.2rem);
  --type-heading-lg: clamp(1.35rem, 1.5vw, 1.7rem);
  --type-heading-md: clamp(1.12rem, 1.05vw, 1.32rem);
  --type-body-lg: clamp(1.03rem, 0.52vw, 1.2rem);
  --type-body-md: 1rem;
  --type-body-sm: 0.93rem;
  --type-caption: 0.82rem;
  --type-eyebrow: 0.74rem;
  --type-line-height-body: 1.62;
  --type-line-height-body-md: 1.58;
  --type-line-height-body-sm: 1.52;
  --reading-measure: 67ch;
}

:root[data-theme="light"] {
  color-scheme: light;
}

:root[data-theme="dark"] {
  color-scheme: dark;
}

:root[data-theme-pack="sunrise"] {
  --background: #fff8f3;
  --foreground: #3f2d2e;
  --surface: #ffffff;
  --surface-muted: #ffe9da;
  --border: #ffd2bd;
  --accent: #ff6f91;
  --success: #29b96f;
  --warn: #ffa733;
  --danger: #ff5f78;
  --gradient-hero: linear-gradient(135deg, #ffd6e5 0%, #ffe9bf 45%, #c8f1ff 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.95),
    9px 9px 18px rgba(188, 102, 112, 0.16);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(188, 102, 112, 0.17),
    inset -5px -5px 10px rgba(255, 255, 255, 0.9);
}

:root[data-theme-pack="ocean"] {
  --background: #f2fcff;
  --foreground: #22425e;
  --surface: #ffffff;
  --surface-muted: #dcf4ff;
  --border: #b7e3ff;
  --accent: #22b8ff;
  --success: #2cbf9c;
  --warn: #ffb346;
  --danger: #ff6a78;
  --gradient-hero: linear-gradient(135deg, #d7f7ff 0%, #dbefff 45%, #e4e0ff 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.95),
    9px 9px 18px rgba(42, 119, 174, 0.15);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(42, 119, 174, 0.15),
    inset -5px -5px 10px rgba(255, 255, 255, 0.9);
}

:root[data-theme-pack="forest"] {
  --background: #f4fff7;
  --foreground: #234131;
  --surface: #ffffff;
  --surface-muted: #e2f9ea;
  --border: #b8ebc8;
  --accent: #2fc46e;
  --success: #2fc46e;
  --warn: #f2b33e;
  --danger: #ff6978;
  --gradient-hero: linear-gradient(135deg, #dcffe9 0%, #d8f8da 45%, #dff5ff 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.95),
    9px 9px 18px rgba(56, 123, 77, 0.15);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(56, 123, 77, 0.15),
    inset -5px -5px 10px rgba(255, 255, 255, 0.9);
}

:root[data-theme-pack="candy"] {
  --background: #fff6ff;
  --foreground: #3b2b49;
  --surface: #ffffff;
  --surface-muted: #ffe7fb;
  --border: #f8c6f4;
  --accent: #ff56b3;
  --success: #33c97c;
  --warn: #ffb861;
  --danger: #ff678e;
  --gradient-hero: linear-gradient(135deg, #ffdff7 0%, #ffe8ca 45%, #d8e7ff 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.95),
    9px 9px 18px rgba(163, 72, 138, 0.15);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(163, 72, 138, 0.15),
    inset -5px -5px 10px rgba(255, 255, 255, 0.9);
}

:root[data-theme-pack="space"] {
  --background: #f6f6ff;
  --foreground: #2a2a5a;
  --surface: #ffffff;
  --surface-muted: #e8e9ff;
  --border: #cccfff;
  --accent: #7b78ff;
  --success: #35c882;
  --warn: #ffbe62;
  --danger: #ff6f86;
  --gradient-hero: linear-gradient(135deg, #e3e5ff 0%, #f1f7ff 45%, #f8e8ff 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.95),
    9px 9px 18px rgba(93, 88, 181, 0.15);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(93, 88, 181, 0.15),
    inset -5px -5px 10px rgba(255, 255, 255, 0.9);
}

:root[data-theme-pack="simple"] {
  --background: #fffdf6;
  --foreground: #2f2942;
  --surface: #ffffff;
  --surface-muted: #f9f2ff;
  --border: #ead8ff;
  --accent: #ff7aa2;
  --success: #22b46e;
  --warn: #ffb341;
  --danger: #ff5f7f;
  --gradient-hero: linear-gradient(135deg, #ffe6f3 0%, #fff6d7 50%, #dbf8ff 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.92),
    9px 9px 18px rgba(131, 92, 153, 0.15);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(131, 92, 153, 0.16),
    inset -5px -5px 10px rgba(255, 255, 255, 0.88);
}

:root[data-theme="dark"] {
  --background: #121925;
  --foreground: #e8eef8;
  --surface: #1a2332;
  --surface-muted: #223045;
  --border: #34465f;
  --accent: #7ebdff;
  --success: #34d399;
  --warn: #fbbf24;
  --danger: #fb7185;
  --gradient-hero: linear-gradient(135deg, #1a2738 0%, #1d3441 46%, #2a2f4a 100%);
  --shadow-soft-raised: -8px -8px 16px rgba(255, 255, 255, 0.02),
    9px 9px 18px rgba(0, 0, 0, 0.42);
  --shadow-soft-pressed: inset 5px 5px 10px rgba(0, 0, 0, 0.45),
    inset -5px -5px 10px rgba(255, 255, 255, 0.02);
  --focus-ring: color-mix(in srgb, var(--accent) 58%, white 18%);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-surface: var(--surface);
  --color-surface-muted: var(--surface-muted);
  --color-border: var(--border);
  --color-accent: var(--accent);
  --color-success: var(--success);
  --color-warn: var(--warn);
  --color-danger: var(--danger);
  --font-sans: var(--font-body-sans);
  --font-mono: var(--font-code-mono);
  --radius-soft-card: var(--radius-card);
  --radius-soft-pill: var(--radius-pill);
  --ease-organic-token: var(--ease-organic);
  --ease-spring-token: var(--ease-spring);
  --duration-fast-token: var(--dur-fast);
  --duration-normal-token: var(--dur-normal);
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    --background: #121925;
    --foreground: #e8eef8;
    --surface: #1a2332;
    --surface-muted: #223045;
    --border: #34465f;
    --accent: #7ebdff;
    --success: #34d399;
    --warn: #fbbf24;
    --danger: #fb7185;
    --gradient-hero: linear-gradient(135deg, #1a2738 0%, #1d3441 46%, #2a2f4a 100%);
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-body-sans), "Segoe UI", sans-serif;
  line-height: var(--type-line-height-body);
  text-rendering: optimizeLegibility;
  font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
  font-optical-sizing: auto;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  letter-spacing: -0.015em;
  line-height: 1.15;
  text-wrap: balance;
  font-optical-sizing: auto;
}

h1 {
  font-size: var(--type-display-xl);
}

h2 {
  font-size: var(--type-display-lg);
}

h3 {
  font-size: var(--type-heading-xl);
}

h4 {
  font-size: var(--type-heading-lg);
}

h5,
h6 {
  font-size: var(--type-heading-md);
}

p,
li,
label,
input,
textarea,
button,
select {
  font-family: var(--font-body-sans), "Segoe UI", sans-serif;
}

code,
pre,
kbd,
samp {
  font-family: var(--font-code-mono), ui-monospace, SFMono-Regular, Menlo, monospace;
}

.ui-type-display {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  letter-spacing: -0.015em;
}

.ui-type-hero {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-display-2xl);
  font-weight: 800;
  line-height: 1.02;
  letter-spacing: -0.032em;
  text-wrap: balance;
}

.ui-type-display-xl {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-display-xl);
  font-weight: 780;
  line-height: 1.06;
  letter-spacing: -0.026em;
  text-wrap: balance;
}

.ui-type-display-lg {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-display-lg);
  font-weight: 760;
  line-height: 1.1;
  letter-spacing: -0.021em;
  text-wrap: balance;
}

.ui-type-heading-xl {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-heading-xl);
  font-weight: 730;
  line-height: 1.16;
  letter-spacing: -0.015em;
  text-wrap: balance;
}

.ui-type-heading-lg {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-heading-lg);
  font-weight: 700;
  line-height: 1.2;
  letter-spacing: -0.011em;
}

.ui-type-heading-md {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-heading-md);
  font-weight: 690;
  line-height: 1.25;
  letter-spacing: -0.008em;
}

.ui-type-body-lg {
  font-size: var(--type-body-lg);
  line-height: var(--type-line-height-body);
  letter-spacing: -0.003em;
}

.ui-type-body-md {
  font-size: var(--type-body-md);
  line-height: var(--type-line-height-body-md);
  letter-spacing: -0.002em;
}

.ui-type-body-sm {
  font-size: var(--type-body-sm);
  line-height: var(--type-line-height-body-sm);
}

.ui-type-caption {
  font-size: var(--type-caption);
  line-height: 1.4;
  letter-spacing: 0.01em;
}

.ui-type-eyebrow {
  font-family: var(--font-display-sans), var(--font-body-sans), "Segoe UI", sans-serif;
  font-size: var(--type-eyebrow);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.13em;
}

.ui-reading-measure {
  max-width: var(--reading-measure);
}

:root[data-typography-density="compact"] {
  --type-display-2xl: clamp(2.35rem, 5.1vw, 4.4rem);
  --type-display-xl: clamp(2rem, 3.8vw, 3.45rem);
  --type-display-lg: clamp(1.72rem, 2.45vw, 2.58rem);
  --type-heading-xl: clamp(1.45rem, 1.95vw, 2rem);
  --type-heading-lg: clamp(1.26rem, 1.36vw, 1.58rem);
  --type-heading-md: clamp(1.06rem, 0.96vw, 1.22rem);
  --type-body-lg: clamp(0.99rem, 0.44vw, 1.11rem);
  --type-body-md: 0.96rem;
  --type-body-sm: 0.89rem;
  --type-caption: 0.79rem;
  --type-eyebrow: 0.71rem;
  --type-line-height-body: 1.54;
  --type-line-height-body-md: 1.5;
  --type-line-height-body-sm: 1.45;
  --reading-measure: 62ch;
}

:root[data-typography-density="spacious"] {
  --type-display-2xl: clamp(2.85rem, 6.4vw, 5.6rem);
  --type-display-xl: clamp(2.35rem, 4.9vw, 4.1rem);
  --type-display-lg: clamp(2.02rem, 3.25vw, 3.08rem);
  --type-heading-xl: clamp(1.72rem, 2.45vw, 2.38rem);
  --type-heading-lg: clamp(1.44rem, 1.72vw, 1.86rem);
  --type-heading-md: clamp(1.18rem, 1.18vw, 1.42rem);
  --type-body-lg: clamp(1.09rem, 0.62vw, 1.27rem);
  --type-body-md: 1.04rem;
  --type-body-sm: 0.97rem;
  --type-caption: 0.85rem;
  --type-eyebrow: 0.77rem;
  --type-line-height-body: 1.7;
  --type-line-height-body-md: 1.64;
  --type-line-height-body-sm: 1.58;
  --reading-measure: 72ch;
}

.ui-focus-ring:focus-visible {
  outline: 3px solid var(--focus-ring);
  outline-offset: 2px;
}

.ui-soft-card {
  border-radius: var(--radius-card);
  background: var(--surface);
  border: 1px solid color-mix(in srgb, var(--border) 86%, white 14%);
  box-shadow: var(--shadow-soft-raised);
  transition: transform var(--dur-fast) var(--ease-organic),
    box-shadow var(--dur-fast) var(--ease-organic),
    background-color var(--dur-fast) var(--ease-organic),
    border-color var(--dur-fast) var(--ease-organic);
}

.ui-soft-card--interactive:hover {
  transform: translateY(-1px);
}

.ui-soft-card--interactive:active {
  transform: translateY(0);
  box-shadow: var(--shadow-soft-pressed);
}

.ui-soft-button {
  border-radius: var(--radius-pill);
  transition: transform var(--dur-fast) var(--ease-organic),
    box-shadow var(--dur-fast) var(--ease-organic),
    background-color var(--dur-fast) var(--ease-organic),
    border-color var(--dur-fast) var(--ease-organic),
    color var(--dur-fast) var(--ease-organic);
}

.ui-soft-button:active {
  transform: translateY(1px);
}

.ui-soft-tab-pill {
  border-radius: var(--radius-pill);
  transition: transform var(--dur-fast) var(--ease-organic),
    background-color var(--dur-fast) var(--ease-organic),
    color var(--dur-fast) var(--ease-organic),
    border-color var(--dur-fast) var(--ease-organic);
}

.ui-progress {
  appearance: none;
  border: 1px solid color-mix(in srgb, var(--border) 70%, white 30%);
  border-radius: var(--radius-pill);
  background: color-mix(in srgb, var(--surface-muted) 75%, white 25%);
  overflow: hidden;
}

.ui-progress::-webkit-progress-bar {
  background: color-mix(in srgb, var(--surface-muted) 75%, white 25%);
}

.ui-progress::-webkit-progress-value {
  background: var(--accent);
  border-radius: var(--radius-pill);
  transition: inline-size var(--dur-fast) var(--ease-organic);
}

.ui-progress::-moz-progress-bar {
  background: var(--accent);
  border-radius: var(--radius-pill);
}

.ui-progress--accent::-webkit-progress-value,
.ui-progress--accent::-moz-progress-bar {
  background: var(--accent);
}

.ui-progress--violet::-webkit-progress-value,
.ui-progress--violet::-moz-progress-bar {
  background: #8b5cf6;
}

.ui-progress--sky::-webkit-progress-value,
.ui-progress--sky::-moz-progress-bar {
  background: #0ea5e9;
}

.lesson-flip-scene {
  perspective: 1000px;
}

.lesson-flip-inner {
  position: relative;
  min-height: 196px;
  transform-style: preserve-3d;
  transition: transform var(--dur-normal) var(--ease-spring);
}

.lesson-flip-inner.is-back {
  transform: rotateY(180deg);
}

.lesson-flip-face {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  border-radius: calc(var(--radius-card) - 2px);
  backface-visibility: hidden;
}

.lesson-flip-back {
  transform: rotateY(180deg);
}

[data-motion="reduced"] .lesson-flip-inner {
  transform: none;
}

[data-motion="reduced"] .lesson-flip-face {
  transition: opacity var(--dur-fast) linear;
}

[data-motion="reduced"] .lesson-flip-front {
  opacity: 1;
}

[data-motion="reduced"] .lesson-flip-back {
  opacity: 0;
}

[data-motion="reduced"] .lesson-flip-inner.is-back .lesson-flip-front {
  opacity: 0;
}

[data-motion="reduced"] .lesson-flip-inner.is-back .lesson-flip-back {
  opacity: 1;
}

@keyframes lesson-quiz-shake {
  0% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-3px);
  }
  50% {
    transform: translateX(3px);
  }
  75% {
    transform: translateX(-2px);
  }
  100% {
    transform: translateX(0);
  }
}

.lesson-quiz-option {
  transition: transform var(--dur-fast) var(--ease-organic),
    border-color var(--dur-fast) var(--ease-organic),
    background-color var(--dur-fast) var(--ease-organic),
    box-shadow var(--dur-fast) var(--ease-organic);
}

.lesson-quiz-option:not(:disabled):hover {
  transform: translateY(-1px);
}

.lesson-quiz-option.is-selected {
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent) 20%, white 80%);
}

.lesson-quiz-option.is-correct {
  transform: scale(1.01);
}

.lesson-quiz-option.is-wrong {
  animation: lesson-quiz-shake 220ms var(--ease-organic) 1;
}

[data-motion="reduced"] .lesson-quiz-option,
[data-motion="reduced"] .lesson-quiz-option.is-correct {
  transform: none !important;
}

[data-motion="reduced"] .lesson-quiz-option.is-wrong {
  animation: none !important;
}

@keyframes lesson-panel-enter {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.lesson-tab-panel {
  animation: lesson-panel-enter var(--dur-fast) var(--ease-organic);
}

[data-motion="reduced"] .lesson-tab-panel {
  animation: none !important;
}

[data-motion="reduced"] * {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

:root[data-contrast="high"] {
  --border: color-mix(in srgb, var(--foreground) 45%, var(--background));
  --accent: color-mix(in srgb, var(--accent) 82%, #ffffff);
}

/* ═══════════════════════════════════════════════
   Explore / Visual Discovery World animations
   ═══════════════════════════════════════════════ */

/* Page transition — smooth fade for explore route changes */
@keyframes explore-page-enter {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.explore-page-enter {
  animation: explore-page-enter 350ms var(--ease-organic) both;
}

[data-motion="reduced"] .explore-page-enter {
  animation: none !important;
  opacity: 1;
  transform: none;
}

/* Immersive explore layout — translucent toolbar */
.explore-toolbar {
  background: linear-gradient(
    to bottom,
    color-mix(in srgb, var(--background) 85%, transparent),
    color-mix(in srgb, var(--background) 60%, transparent)
  );
  border-bottom: 1px solid color-mix(in srgb, var(--foreground) 6%, transparent);
}

/* Active nav link indicator */
.explore-toolbar-link-active {
  background: color-mix(in srgb, var(--foreground) 6%, transparent);
  color: var(--foreground);
}

[data-pre-reader-mode="on"] .explore-toolbar {
  gap: 0.4rem;
}

[data-pre-reader-mode="on"] .explore-toolbar .ui-focus-ring {
  min-height: 44px;
  min-width: 44px;
  justify-content: center;
}

[data-pre-reader-mode="on"] .explore-copy-heavy {
  display: none !important;
}

[data-pre-reader-mode="on"] .explore-scene-card {
  min-height: 320px;
}

[data-pre-reader-mode="on"] .explore-bubble {
  min-height: 190px;
  justify-content: center;
}

/* Keep global TopNav visible; hide footer only on immersive explore surfaces */
.explore-shell ~ footer {
  display: none;
}

/* Scene entrance — fade + slide up with stagger support */
@keyframes explore-scene-enter {
  from {
    opacity: 0;
    transform: translateY(16px) scale(0.97);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.explore-scene-enter {
  animation: explore-scene-enter 500ms var(--ease-organic) both;
}

/* Gentle float for badges and decorative elements */
@keyframes explore-float {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-6px);
  }
}

.explore-float {
  animation: explore-float 3s ease-in-out infinite;
}

/* Pulse ring for "tap me" indicators */
@keyframes explore-pulse {
  0%,
  100% {
    opacity: 0.6;
    transform: translateX(-50%) scale(1);
  }
  50% {
    opacity: 1;
    transform: translateX(-50%) scale(1.8);
  }
}

.explore-pulse {
  animation: explore-pulse 2s ease-in-out infinite;
}

@keyframes auth-orb-drift {
  0%,
  100% {
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% {
    transform: translate3d(0, -14px, 0) scale(1.05);
  }
}

.auth-orb-drift {
  animation: auth-orb-drift 9s ease-in-out infinite;
}

.auth-orb-drift-delayed {
  animation: auth-orb-drift 12s ease-in-out -2.4s infinite;
}

.auth-orb-drift-slow {
  animation: auth-orb-drift 15s ease-in-out -1.8s infinite;
}

/* Scene card hover glow ring */
.explore-scene-card {
  transition: transform 300ms var(--ease-organic),
    box-shadow 300ms var(--ease-organic);
  cursor: pointer;
}

.explore-scene-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 40px color-mix(in srgb, var(--glow, #7b78ff) 25%, transparent);
}

/* Question bubble hover lift */
.explore-bubble {
  cursor: pointer;
}

.explore-bubble::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: 30px;
  opacity: 0;
  transition: opacity 300ms var(--ease-organic);
  box-shadow: 0 0 24px color-mix(in srgb, var(--glow, #7b78ff) 30%, transparent);
  pointer-events: none;
}

.explore-bubble:hover::before {
  opacity: 1;
}

/* Correct answer bounce for visual quiz */
@keyframes explore-correct-bounce {
  0% {
    transform: scale(1);
  }
  40% {
    transform: scale(1.04);
  }
  100% {
    transform: scale(1);
  }
}

.explore-correct-bounce {
  animation: explore-correct-bounce 400ms var(--ease-spring) 1;
}

/* Respect reduced motion for all explore animations */
[data-motion="reduced"] .explore-scene-enter {
  animation: none !important;
  opacity: 1;
  transform: none;
}

[data-motion="reduced"] .explore-float {
  animation: none !important;
}

[data-motion="reduced"] .explore-pulse {
  animation: none !important;
}

[data-motion="reduced"] .auth-orb-drift,
[data-motion="reduced"] .auth-orb-drift-delayed,
[data-motion="reduced"] .auth-orb-drift-slow {
  animation: none !important;
}

[data-motion="reduced"] .explore-scene-card:hover {
  transform: none;
}

[data-motion="reduced"] .explore-correct-bounce {
  animation: none !important;
}

@media (prefers-reduced-motion: reduce) {
  .explore-page-enter,
  .explore-scene-enter {
    animation: none !important;
    opacity: 1;
    transform: none;
  }

  .explore-float,
  .explore-pulse {
    animation: none !important;
  }

  .auth-orb-drift,
  .auth-orb-drift-delayed,
  .auth-orb-drift-slow {
    animation: none !important;
  }

  .explore-scene-card:hover {
    transform: none;
  }

  .explore-correct-bounce {
    animation: none !important;
  }

  .explore-wrong-shake {
    animation: none !important;
  }

  .explore-confetti-burst span {
    animation: none !important;
  }

  .explore-card-pop {
    animation: none !important;
  }
}

/* Wrong answer shake */
@keyframes explore-wrong-shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-6px); }
  40% { transform: translateX(6px); }
  60% { transform: translateX(-4px); }
  80% { transform: translateX(4px); }
}

.explore-wrong-shake {
  animation: explore-wrong-shake 400ms ease-in-out 1;
}

[data-motion="reduced"] .explore-wrong-shake {
  animation: none !important;
}

/* Card pop-in for staggered lists */
@keyframes explore-card-pop {
  from {
    opacity: 0;
    transform: scale(0.85) translateY(8px);
  }
  60% {
    opacity: 1;
    transform: scale(1.03) translateY(-2px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.explore-card-pop {
  animation: explore-card-pop 350ms var(--ease-spring) both;
}

[data-motion="reduced"] .explore-card-pop {
  animation: none !important;
  opacity: 1;
}

/* Confetti burst for celebration */
@keyframes explore-confetti-fall {
  0% {
    opacity: 1;
    transform: translateY(0) rotate(0deg) scale(1);
  }
  80% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translateY(100vh) rotate(720deg) scale(0.3);
  }
}

.explore-confetti-burst {
  position: fixed;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 50;
}

.explore-confetti-burst span {
  position: absolute;
  top: -20px;
  display: block;
  width: 10px;
  height: 10px;
  border-radius: 2px;
  animation: explore-confetti-fall var(--fall-duration, 2.5s) var(--fall-delay, 0s) ease-in forwards;
}

/* Glow ring for selected interactive elements */
.explore-glow-ring {
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--glow, #7b78ff) 30%, transparent);
}

/* Elevated card depth */
.explore-card-elevated {
  box-shadow:
    0 4px 6px -1px rgb(0 0 0 / 0.07),
    0 10px 30px -4px rgb(0 0 0 / 0.08);
}

/* Star glow effect for celebration */
@keyframes explore-star-glow {
  0%, 100% {
    filter: drop-shadow(0 0 4px gold);
  }
  50% {
    filter: drop-shadow(0 0 12px gold) drop-shadow(0 0 20px rgba(255, 215, 0, 0.4));
  }
}

.explore-star-glow {
  animation: explore-star-glow 2s ease-in-out infinite;
}

[data-motion="reduced"] .explore-star-glow {
  animation: none !important;
  filter: drop-shadow(0 0 6px gold);
}

/* Sound bar equalizer for speak button */
@keyframes explore-sound-bar {
  0%, 100% { transform: scaleY(0.4); }
  50% { transform: scaleY(1); }
}

.explore-sound-bar {
  animation: explore-sound-bar 600ms ease-in-out infinite;
  transform-origin: bottom;
}

[data-motion="reduced"] .explore-sound-bar {
  animation: none !important;
  transform: scaleY(0.7);
}

/* ─── Family UX System ─────────────────────────── */

/* Shared ambient gradient backdrop for family pages */
.family-ambient-bg {
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0.25;
  background:
    radial-gradient(ellipse at 22% 35%, #a7f3d0 0%, transparent 50%),
    radial-gradient(ellipse at 72% 22%, #c4b5fd 0%, transparent 48%),
    radial-gradient(ellipse at 48% 82%, #fde68a 0%, transparent 44%),
    radial-gradient(ellipse at 8% 78%, #bfdbfe 0%, transparent 38%);
}

/* Step indicator pill track */
.family-step-track {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.family-step-dot {
  width: 2.25rem;
  height: 0.25rem;
  border-radius: var(--radius-pill);
  background: color-mix(in srgb, var(--border) 60%, transparent);
  transition: background var(--dur-normal) var(--ease-organic),
    transform var(--dur-normal) var(--ease-spring);
}

.family-step-dot[data-active="true"] {
  background: var(--accent);
  transform: scaleX(1.4);
}

.family-step-dot[data-complete="true"] {
  background: var(--success);
}

/* Staggered card entrance for family pages */
@keyframes family-card-enter {
  from {
    opacity: 0;
    transform: translateY(12px) scale(0.97);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.family-card-enter {
  animation: family-card-enter 400ms var(--ease-organic) both;
}

/* Saving / progress spinner */
@keyframes family-orbit {
  to { transform: rotate(360deg); }
}

.family-orbit-spinner {
  width: 3rem;
  height: 3rem;
  border-radius: 50%;
  border: 3px solid color-mix(in srgb, var(--success) 25%, transparent);
  border-top-color: var(--success);
  animation: family-orbit 800ms linear infinite;
}

/* Success state bounce */
@keyframes family-success-pop {
  0% { transform: scale(0.8); opacity: 0; }
  60% { transform: scale(1.06); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

.family-success-pop {
  animation: family-success-pop 500ms var(--ease-spring) both;
}

/* Profile card hover glow ring */
.family-profile-card {
  --glow: transparent;
  transition: transform var(--dur-normal) var(--ease-organic),
    box-shadow var(--dur-normal) var(--ease-organic);
}

.family-profile-card:hover,
.family-profile-card:focus-visible {
  transform: translateY(-3px);
  box-shadow: 0 8px 28px -4px var(--glow), var(--shadow-soft-raised);
}

.family-profile-card:active {
  transform: translateY(0) scale(0.97);
}

/* Error/status banner slide-in */
@keyframes family-banner-enter {
  from { opacity: 0; transform: translateY(-8px); }
  to   { opacity: 1; transform: translateY(0); }
}

.family-banner {
  animation: family-banner-enter 300ms var(--ease-organic) both;
}

/* Reduced-motion overrides for family animations */
[data-motion="reduced"] .family-card-enter,
[data-motion="reduced"] .family-success-pop,
[data-motion="reduced"] .family-banner {
  animation: none !important;
  opacity: 1;
  transform: none;
}

[data-motion="reduced"] .family-orbit-spinner {
  animation-duration: 2s;
}

[data-motion="reduced"] .family-profile-card:hover,
[data-motion="reduced"] .family-profile-card:focus-visible {
  transform: none;
}

@media (prefers-reduced-motion: reduce) {
  .family-card-enter,
  .family-success-pop,
  .family-banner {
    animation: none !important;
    opacity: 1;
    transform: none;
  }

  .family-orbit-spinner {
    animation-duration: 2s;
  }

  .family-profile-card:hover,
  .family-profile-card:focus-visible {
    transform: none;
  }
}

/* ─── End Family UX System ────────────────────── */

/* Smooth scroll for explore pages */
.explore-shell {
  scroll-behavior: smooth;
}

/* ── Landing Page Glass Cube Animations ──────────── */

/* Slow levitation for glass cubes */
@keyframes landing-cube-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

/* Pulse glow halo behind cubes */
@keyframes landing-glow-pulse {
  0%, 100% { opacity: 0.12; filter: blur(18px); }
  50% { opacity: 0.28; filter: blur(24px); }
}

/* Subtle sparkle / glint on cube corners */
@keyframes landing-sparkle {
  0%, 100% { opacity: 0; transform: scale(0.6); }
  50% { opacity: 1; transform: scale(1); }
}

/* Hero headline shimmer (optional gold sweep) */
@keyframes landing-text-shimmer {
  0% { background-position: -200% center; }
  100% { background-position: 200% center; }
}

/* Fade-slide up for section reveals */
@keyframes landing-reveal {
  from { opacity: 0; transform: translateY(24px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Apply floating animation to glass cubes */
.glass-cube {
  animation: landing-cube-float 5s ease-in-out infinite;
}

/* Stagger the float so cubes don't move in unison */
.glass-cube:nth-child(2n) { animation-delay: 0.6s; }
.glass-cube:nth-child(3n) { animation-delay: 1.2s; }
.glass-cube:nth-child(5n) { animation-delay: 1.8s; }
.glass-cube:nth-child(7n) { animation-delay: 2.4s; }

/* Section reveal class */
.landing-section {
  animation: landing-reveal 0.7s var(--ease-organic) both;
}
.landing-section:nth-of-type(2) { animation-delay: 0.15s; }
.landing-section:nth-of-type(3) { animation-delay: 0.3s; }
.landing-section:nth-of-type(4) { animation-delay: 0.45s; }

/* ── End Landing Page Animations ──────────────────── */

@media (prefers-reduced-motion: reduce) {
  .explore-wrong-shake,
  .explore-card-pop,
  .explore-star-glow,
  .explore-sound-bar {
    animation: none !important;
  }

  .explore-confetti-burst span {
    animation: none !important;
  }

  .explore-shell {
    scroll-behavior: auto;
  }

  .glass-cube,
  .landing-section {
    animation: none !important;
  }
}
